{% extends 'base.html' %}
{% block title %}{{ heading }}{% endblock %}

{% block content %}
<style>
.container { max-width:600px; margin:50px auto; background:#fff; padding:30px; border-radius:10px; box-shadow:0 4px 12px rgba(0,0,0,0.1); font-family:Arial,sans-serif;}
h4 { font-size:28px; color:#0f766e; margin-bottom:20px; text-align:center;}
.form-group { margin-bottom:15px;}
.form-label { display:block; margin-bottom:5px; font-weight:bold;}
.form-control { width:100% !important; padding:10px; border:1px solid #ced4da; border-radius:5px; font-size:16px;}
.form-control:focus { outline:none; border-color:#0f766e; box-shadow:0 0 5px rgba(15,118,110,0.5);}
.password-field { position:relative;}
.toggle-password { position:absolute; top:50%; right:10px; transform:translateY(-50%); background:transparent; border:none; color:#0f766e; cursor:pointer; font-size:14px;}
.btn-primary { width:100%; padding:12px; background-color:#0f766e; border:none; border-radius:6px; color:white; font-size:18px; cursor:pointer; margin-top:15px; transition:0.3s;}
.btn-primary:hover { background-color:#065f52;}
.alert { padding:15px; border-radius:5px; margin-top:20px; background-color:#f8d7da; color:#721c24; border:1px solid #f5c6cb;}
a { color:#0f766e; text-decoration:none;}
a:hover { text-decoration:underline;}
@media(max-width:768px){ .container{ margin:30px 15px; padding:20px; } }
</style>

<div class="container">
    <h4>{{ heading }}</h4>

    <form method="post" action="{% url 'register' %}">
        {% csrf_token %}
        {{ form.user_type }} <!-- Hidden field -->

        <div class="form-group">
            <label for="id_username" class="form-label">Username</label>
            {{ form.username }}
        </div>

        <div class="form-group">
            <label for="id_email" class="form-label">Email</label>
            {{ form.email }}
        </div>

        <div class="form-group">
            <label for="id_password1" class="form-label">Password</label>
            <div class="password-field">
                {{ form.password1 }}
                <button type="button" class="toggle-password" data-toggle-for="id_password1" onclick="togglePasswordVisibility('id_password1')">Show</button>
            </div>
        </div>

        <div class="form-group">
            <label for="id_password2" class="form-label">Confirm Password</label>
            <div class="password-field">
                {{ form.password2 }}
            </div>
        </div>

        <button type="submit" class="btn-primary">Register</button>
    </form>

    <p style="margin-top:15px; text-align:center;">Already a user? <a href="{% url 'login' %}">Login Now</a></p>

    {% if form.errors %}
    <div class="alert">
        <ul>
            {% for field, errors in form.errors.items %}
                {% for error in errors %}
                    <li><strong>{{ field }}:</strong> {{ error }}</li>
                {% endfor %}
            {% endfor %}
        </ul>
    </div>
    {% endif %}
</div>

<script>
function togglePasswordVisibility(fieldId){
    var field = document.getElementById(fieldId);
    var toggleButton = document.querySelector(`[data-toggle-for=${fieldId}]`);
    if(field.type === "password"){
        field.type = "text";
        toggleButton.textContent = "Hide";
    } else {
        field.type = "password";
        toggleButton.textContent = "Show";
    }
}
</script>
{% endblock %}
